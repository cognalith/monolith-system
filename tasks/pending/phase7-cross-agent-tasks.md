# Phase 7 Cross-Agent Tasks
## Generated by DevOps Engineer (Agent 4)
## Date: $(date +%Y-%m-%d)

These tasks require coordination with other agents to complete the Phase 7 Security & Compliance implementation.

---

## ðŸ”´ HIGH PRIORITY

### Backend Developer (Agent 2)

#### TLS-API-01: Update API endpoints for SSL
**Description:** Update all API endpoints to enforce SSL/TLS connections to the Supabase database.
**Files to modify:** 
- `dashboard/src/api/*.js`
- Any database connection configurations
**Action:** Ensure connection strings include `?sslmode=require`
**Depends on:** DevOps enabling SSL enforcement (âœ… DONE)

#### TLS-API-02: SSL Certificate Configuration  
**Description:** Configure API to use proper SSL certificates when connecting to database.
**Files:** Connection pool configuration
**Note:** SSL certificate available at Supabase Dashboard > Database Settings > Download certificate

#### IDS-INT-01: Integrate Intrusion Detection Middleware
**Description:** Import and use the IDS middleware in the Express application.
**File created:** `infrastructure/security/intrusion-detection.js`
**Integration code:**
\`\`\`javascript
const { IntrusionDetectionSystem, slackAlertHandler } = require('../infrastructure/security/intrusion-detection');
const ids = new IntrusionDetectionSystem();
ids.onAlert(slackAlertHandler);
app.use(ids.middleware());
\`\`\`

---

### Security Engineer (Agent 5)

#### IDS-REV-01: Review IDS Thresholds
**Description:** Review and validate the security thresholds configured in intrusion-detection.js
**File:** `infrastructure/security/intrusion-detection.js`
**Current thresholds:**
- Failed logins: 5 in 5 minutes
- API requests: 100/minute, 1000/hour
- SQL injection: 1 attempt = block
- XSS: 1 attempt = block

#### IDS-REV-02: Validate SQL Injection Patterns
**Description:** Review SQL injection regex patterns for completeness
**Current patterns cover:** Basic injection, UNION attacks, comment injection
**Consider adding:** Blind injection, time-based attacks, stored procedures

#### IDS-REV-03: Review XSS Detection Patterns
**Description:** Validate XSS patterns catch modern attack vectors
**File:** `infrastructure/security/intrusion-detection.js` (SUSPICIOUS_PATTERNS.xss)

---

### Database Architect (Agent 1)

#### DR-TEST-01: Execute Disaster Recovery Drill
**Description:** Schedule and run a full DR drill using the backup restoration process
**Runbook:** `infrastructure/disaster-recovery/RUNBOOK.md`
**Steps:**
1. Download latest backup from S3
2. Restore to test database
3. Verify all tables and data integrity
4. Document results and recovery time

#### DR-TEST-02: Validate Backup Integrity
**Description:** Verify backup files contain valid, complete data
**Script:** `infrastructure/backup/verify-backup.sh`
**Tables to verify:** workflows, tasks, decision_logs, dashboard_stats

#### PITR-01: PITR Evaluation
**Description:** Evaluate if Point-in-Time Recovery is required for compliance
**Current status:** Not enabled (requires Supabase Pro + $100/mo addon)
**Question:** Does the 1-hour RPO requirement mandate PITR?

---

## ðŸŸ¡ MEDIUM PRIORITY

### Backend Developer (Agent 2)

#### MON-INT-01: Security Event Logging
**Description:** Add security event logging to critical API endpoints
**Use:** `infrastructure/monitoring/security-monitoring.js`
**Events to log:** Authentication attempts, data access, admin actions

---

### Security Engineer (Agent 5)

#### PEN-TEST-01: IDS Penetration Test
**Description:** Run penetration tests against the IDS to verify it catches attacks
**Test vectors:** SQL injection, XSS, path traversal, rate limiting

#### ALERT-REV-01: Alert Threshold Review
**Description:** Review alerting thresholds to minimize false positives
**Monitor:** Slack/PagerDuty alerts after 1 week of production usage

---

### Database Architect (Agent 1)

#### ARCHIVE-01: Data Archival Policy Review
**Description:** Review data archival policies for regulatory compliance
**Current policy:**
- Active data: 90 days
- Archive: 365 days (S3 Glacier)
- Destruction: 730 days

---

## ðŸŸ¢ LOW PRIORITY

### Frontend Developer (Agent 3)

#### SEC-UI-01: Security Status Dashboard Widget
**Description:** Add a security status widget to the admin dashboard
**Data source:** `infrastructure/monitoring/security-monitoring.js`
**Display:** Health status, recent security events, backup status

#### SEC-UI-02: RTO/RPO Metrics Display
**Description:** Display RTO and RPO metrics on the monitoring page
**Metrics:**
- Current RTO estimate: 2.5 hours (target: 4 hours)
- Current RPO: Last backup timestamp
- Backup health: OK/Warning/Critical

---

## Required Secrets (for all agents)

Ensure these are configured in GitHub repository settings:

| Secret | Description | Owner |
|--------|-------------|-------|
| SUPABASE_PROJECT_REF | Supabase project reference | DevOps |
| SUPABASE_DB_PASSWORD | Database password | DevOps |
| AWS_ACCESS_KEY_ID | AWS credentials for S3 | DevOps |
| AWS_SECRET_ACCESS_KEY | AWS credentials for S3 | DevOps |
| AWS_S3_BUCKET | Backup bucket name | DevOps |
| SLACK_WEBHOOK_URL | Slack alerts | DevOps |
| PAGERDUTY_ROUTING_KEY | PagerDuty integration | DevOps |

---

## Completion Criteria

All cross-agent tasks are complete when:
- [ ] IDS middleware integrated into API (Agent 2)
- [ ] IDS patterns reviewed and approved (Agent 5)
- [ ] DR drill executed successfully (Agent 1)
- [ ] Backup integrity verified (Agent 1)
- [ ] Security dashboard UI ready (Agent 3)

---

*Source: DevOps Engineer (Agent 4) - Phase 7 Implementation*
